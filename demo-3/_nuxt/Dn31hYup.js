import{_ as C,o,c as l,p as T,e as j,a as e,f as G,g as J,s as K,u as O,h as L,r as x,i as P,j as Q,k as S,w as p,l as W,b as M,n as k,m as r,q as X,v as w,F as B,x as _,t as g,y as Y}from"./Bj0jl-mm.js";import{_ as Z,a as ss}from"./BwX9z6bP.js";import{_ as es}from"./BJhvYJ_2.js";import{_ as ts}from"./RrJjES1t.js";import{u as as}from"./BqJY-gXM.js";const os={},b=n=>(T("data-v-461a49fa"),n=n(),j(),n),ns={class:"typing-loading"},is=b(()=>e("div",{class:"dot dot1"},null,-1)),cs=b(()=>e("div",{class:"dot dot2"},null,-1)),rs=b(()=>e("div",{class:"dot dot3"},null,-1)),ls=[is,cs,rs];function ds(n,f){return o(),l("div",ns,ls)}const us=C(os,[["render",ds],["__scopeId","data-v-461a49fa"]]),V=G("/img/robot-icon.png"),R=n=>(T("data-v-8ea55de3"),n=n(),j(),n),_s={class:"message-container"},ms={class:"message-wrapper justify-end"},ps={class:"self-box"},gs={class:"message-wrapper justify-start"},fs=R(()=>e("div",{class:"h-10 w-10 mr-3 bg-white rounded-full"},[e("img",{src:V})],-1)),vs={class:"dialog-box"},hs={key:0,class:"flex justify-center items-center text-xs text-gray-400 mb-3"},ys={key:0,class:"h-10 w-10 mr-3 bg-white rounded-full"},xs=R(()=>e("img",{src:V},null,-1)),Ms=[xs],ks={class:"footer-container"},bs={class:"icon-container"},$s=J({__name:"[id]",setup(n){const f=as(),{roomMessages:i,messagesHistory:v}=K(f),{sendMessage:H,getHistory:N}=f,U=O(),t=L(()=>U.params.id),u=x(""),h=x(!1),$=x(!1),q=L(()=>i.value[t.value]||[]),I=()=>{Y(()=>{const s=document.querySelector(".message-container");s&&(s.scrollTop=s.scrollHeight)})},E=async s=>{!s||h.value||(h.value=!0,H({userMessage:s,roomName:t.value}),i.value[t.value].push({role:"userMessage",message:s,isLoading:!1}),i.value[t.value].push({role:"assistantMessage",message:"",isLoading:!0}),u.value="",I())};return P(()=>{var s;return(s=i.value[t.value])==null?void 0:s.map(c=>c.assistantMessage)},s=>{if(s!=null&&s.length){const c=i.value[t.value].findLastIndex(m=>m.role==="assistantMessage"&&m.isLoading);c!==-1&&s[s.length-1]&&(i.value[t.value][c]={role:"assistantMessage",message:s[s.length-1],isLoading:!1},h.value=!1,I())}}),Q(async()=>{await N(t.value),$.value=!0,setTimeout(()=>{var s;((s=i.value[t.value])==null?void 0:s.length)>0&&v.value[t.value].push({userMessage:i.value[t.value][0].userMessage,assistantMessage:i.value[t.value][0].assistantMessage})},500)}),(s,c)=>{const m=us,F=Z,z=es,A=ss,D=ts;return o(),S(D,null,{footer:p(()=>[e("div",ks,[e("form",{onSubmit:c[1]||(c[1]=W(d=>E(r(u)),["prevent"]))},[M(A,{ref:"inputRef",modelValue:r(u),"onUpdate:modelValue":c[0]||(c[0]=d=>X(u)?u.value=d:null),placeholder:"Type your msg here...",icon:"icon-cil-arrow-top",height:70},{icon:p(({icon:d})=>[e("div",bs,[M(z,{type:"submit"},{default:p(()=>[M(F,{class:k([d,"text-white text-lg"])},null,8,["class"])]),_:2},1024)])]),_:1},8,["modelValue"])],32)])]),default:p(()=>{var d;return[e("div",_s,[((d=r(v)[r(t)])==null?void 0:d.length)>0&&r($)?(o(!0),l(B,{key:0},w(r(v)[r(t)],(a,y)=>(o(),l("div",{key:y},[e("div",ms,[e("div",ps,g(a.userMessage),1)]),e("div",gs,[fs,e("div",vs,g(a.assistantMessage),1)])]))),128)):_("",!0),(o(!0),l(B,null,w(r(q),(a,y)=>(o(),l("div",{key:y},[a.date?(o(),l("div",hs,g(a.date),1)):_("",!0),e("div",{class:k([[a.role==="userMessage"?"justify-end":"justify-start"],"message-wrapper"])},[a.role==="assistantMessage"?(o(),l("div",ys,Ms)):_("",!0),a.isLoading?(o(),S(m,{key:1})):_("",!0),!a.isLoading&&a.message?(o(),l("div",{key:2,class:k([a.role==="userMessage"?"self-box":"dialog-box"])},g(a.message),3)):_("",!0)],2)]))),128))])]}),_:1})}}}),Cs=C($s,[["__scopeId","data-v-8ea55de3"]]);export{Cs as default};
