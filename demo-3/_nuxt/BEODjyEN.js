import{_ as C,o as a,c as r,p as j,e as T,a as e,f as G,g as J,s as K,u as O,h as M,r as y,i as P,j as Q,k as S,w as p,l as W,b as x,n as k,m as i,q as X,v as w,F as B,x as _,t as f,y as Y}from"./42bTi8eY.js";import{_ as Z,a as ss}from"./B-vs0SmS.js";import{_ as es}from"./CCUOSAOj.js";import{_ as ts}from"./CThJnWno.js";import{u as os}from"./otVo6fxy.js";const as={},b=n=>(j("data-v-461a49fa"),n=n(),T(),n),ns={class:"typing-loading"},cs=b(()=>e("div",{class:"dot dot1"},null,-1)),is=b(()=>e("div",{class:"dot dot2"},null,-1)),rs=b(()=>e("div",{class:"dot dot3"},null,-1)),ls=[cs,is,rs];function ds(n,g){return a(),r("div",ns,ls)}const us=C(as,[["render",ds],["__scopeId","data-v-461a49fa"]]),V=G("/img/robot-icon.png"),R=n=>(j("data-v-514ced5d"),n=n(),T(),n),_s={class:"message-container"},ms={class:"message-wrapper justify-end"},ps={class:"self-box"},fs={class:"message-wrapper justify-start"},gs=R(()=>e("div",{class:"h-10 w-10 mr-3 bg-white rounded-full"},[e("img",{src:V})],-1)),vs={class:"dialog-box"},hs={key:0,class:"flex justify-center items-center text-xs text-gray-400 mb-3"},ys={key:0,class:"h-10 w-10 mr-3 bg-white rounded-full"},xs=R(()=>e("img",{src:V},null,-1)),ks=[xs],bs={class:"footer-container"},Is={class:"icon-container"},$s=J({__name:"[id]",setup(n){const g=os(),{roomMessages:d,messagesHistory:I}=K(g),{sendMessage:H,getHistory:N}=g,U=O(),o=M(()=>U.params.id),u=y(""),v=y(!1),$=y(!1),q=M(()=>d.value[o.value]||[]),L=()=>{Y(()=>{const s=document.querySelector(".message-container");s&&(s.scrollTop=s.scrollHeight)})},E=async s=>{!s||v.value||(v.value=!0,H({userMessage:s,roomName:o.value}),d.value[o.value].push({role:"userMessage",message:s,isLoading:!1}),d.value[o.value].push({role:"assistantMessage",message:"",isLoading:!0}),u.value="",L())};return P(()=>{var s;return(s=d.value[o.value])==null?void 0:s.map(c=>c.assistantMessage)},s=>{if(s!=null&&s.length){const c=d.value[o.value].findLastIndex(m=>m.role==="assistantMessage"&&m.isLoading);c!==-1&&s[s.length-1]&&(d.value[o.value][c]={role:"assistantMessage",message:s[s.length-1],isLoading:!1},v.value=!1,L())}}),Q(async()=>{await N(o.value),$.value=!0}),(s,c)=>{const m=us,F=Z,z=es,A=ss,D=ts;return a(),S(D,null,{footer:p(()=>[e("div",bs,[e("form",{onSubmit:c[1]||(c[1]=W(l=>E(i(u)),["prevent"]))},[x(A,{ref:"inputRef",modelValue:i(u),"onUpdate:modelValue":c[0]||(c[0]=l=>X(u)?u.value=l:null),placeholder:"Type your msg here...",icon:"icon-cil-arrow-top",height:70},{icon:p(({icon:l})=>[e("div",Is,[x(z,{type:"submit"},{default:p(()=>[x(F,{class:k([l,"text-white text-lg"])},null,8,["class"])]),_:2},1024)])]),_:1},8,["modelValue"])],32)])]),default:p(()=>{var l;return[e("div",_s,[((l=i(I)[i(o)])==null?void 0:l.length)>0&&i($)?(a(!0),r(B,{key:0},w(i(I)[i(o)],(t,h)=>(a(),r("div",{key:h},[e("div",ms,[e("div",ps,f(t.userMessage),1)]),e("div",fs,[gs,e("div",vs,f(t.assistantMessage),1)])]))),128)):_("",!0),(a(!0),r(B,null,w(i(q),(t,h)=>(a(),r("div",{key:h},[t.date?(a(),r("div",hs,f(t.date),1)):_("",!0),e("div",{class:k([[t.role==="userMessage"?"justify-end":"justify-start"],"message-wrapper"])},[t.role==="assistantMessage"?(a(),r("div",ys,ks)):_("",!0),t.isLoading?(a(),S(m,{key:1})):_("",!0),!t.isLoading&&t.message?(a(),r("div",{key:2,class:k([t.role==="userMessage"?"self-box":"dialog-box"])},f(t.message),3)):_("",!0)],2)]))),128))])]}),_:1})}}}),Cs=C($s,[["__scopeId","data-v-514ced5d"]]);export{Cs as default};
