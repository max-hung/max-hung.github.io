import{_ as C,o as a,c as l,p as T,e as j,a as e,f as G,g as J,s as K,u as O,h as L,r as x,i as P,j as Q,k as S,w as p,l as W,b as M,n as k,m as r,q as X,v as w,F as B,x as _,t as g,y as Y}from"./Dr603ncN.js";import{_ as Z,a as ss}from"./EJOI-xYI.js";import{_ as es}from"./CxkTBfO2.js";import{_ as ts}from"./B4HZDwpQ.js";import{u as os}from"./BCwL2CNx.js";const as={},b=n=>(T("data-v-461a49fa"),n=n(),j(),n),ns={class:"typing-loading"},is=b(()=>e("div",{class:"dot dot1"},null,-1)),cs=b(()=>e("div",{class:"dot dot2"},null,-1)),rs=b(()=>e("div",{class:"dot dot3"},null,-1)),ls=[is,cs,rs];function us(n,v){return a(),l("div",ns,ls)}const ds=C(as,[["render",us],["__scopeId","data-v-461a49fa"]]),V=G("/img/robot-icon.png"),R=n=>(T("data-v-8ea55de3"),n=n(),j(),n),_s={class:"message-container"},ms={class:"message-wrapper justify-end"},ps={class:"self-box"},gs={class:"message-wrapper justify-start"},vs=R(()=>e("div",{class:"h-10 w-10 mr-3 bg-white rounded-full"},[e("img",{src:V})],-1)),fs={class:"dialog-box"},hs={key:0,class:"flex justify-center items-center text-xs text-gray-400 mb-3"},ys={key:0,class:"h-10 w-10 mr-3 bg-white rounded-full"},xs=R(()=>e("img",{src:V},null,-1)),Ms=[xs],ks={class:"footer-container"},bs={class:"icon-container"},Is=J({__name:"[id]",setup(n){const v=os(),{roomMessages:i,messagesHistory:f}=K(v),{sendMessage:H,getHistory:N}=v,U=O(),t=L(()=>U.params.id),d=x(""),h=x(!1),I=x(!1),q=L(()=>i.value[t.value]||[]),$=()=>{Y(()=>{const s=document.querySelector(".message-container");s&&(s.scrollTop=s.scrollHeight)})},E=async s=>{!s||h.value||(h.value=!0,H({userMessage:s,roomName:t.value}),i.value[t.value].push({role:"userMessage",message:s,isLoading:!1}),i.value[t.value].push({role:"assistantMessage",message:"",isLoading:!0}),d.value="",$())};return P(()=>{var s;return(s=i.value[t.value])==null?void 0:s.map(c=>c.assistantMessage)},s=>{if(s!=null&&s.length){const c=i.value[t.value].findLastIndex(m=>m.role==="assistantMessage"&&m.isLoading);c!==-1&&s[s.length-1]&&(i.value[t.value][c]={role:"assistantMessage",message:s[s.length-1],isLoading:!1},h.value=!1,$())}}),Q(async()=>{await N(t.value),I.value=!0,setTimeout(()=>{var s;((s=i.value[t.value])==null?void 0:s.length)>0&&f.value[t.value].push({userMessage:i.value[t.value][0].userMessage,assistantMessage:i.value[t.value][0].assistantMessage})},500)}),(s,c)=>{const m=ds,F=Z,z=es,A=ss,D=ts;return a(),S(D,null,{footer:p(()=>[e("div",ks,[e("form",{onSubmit:c[1]||(c[1]=W(u=>E(r(d)),["prevent"]))},[M(A,{ref:"inputRef",modelValue:r(d),"onUpdate:modelValue":c[0]||(c[0]=u=>X(d)?d.value=u:null),placeholder:"Type your msg here...",icon:"icon-cil-arrow-top",height:70},{icon:p(({icon:u})=>[e("div",bs,[M(z,{type:"submit"},{default:p(()=>[M(F,{class:k([u,"text-white text-lg"])},null,8,["class"])]),_:2},1024)])]),_:1},8,["modelValue"])],32)])]),default:p(()=>{var u;return[e("div",_s,[((u=r(f)[r(t)])==null?void 0:u.length)>0&&r(I)?(a(!0),l(B,{key:0},w(r(f)[r(t)],(o,y)=>(a(),l("div",{key:y},[e("div",ms,[e("div",ps,g(o.userMessage),1)]),e("div",gs,[vs,e("div",fs,g(o.assistantMessage),1)])]))),128)):_("",!0),(a(!0),l(B,null,w(r(q),(o,y)=>(a(),l("div",{key:y},[o.date?(a(),l("div",hs,g(o.date),1)):_("",!0),e("div",{class:k([[o.role==="userMessage"?"justify-end":"justify-start"],"message-wrapper"])},[o.role==="assistantMessage"?(a(),l("div",ys,Ms)):_("",!0),o.isLoading?(a(),S(m,{key:1})):_("",!0),!o.isLoading&&o.message?(a(),l("div",{key:2,class:k([o.role==="userMessage"?"self-box":"dialog-box"])},g(o.message),3)):_("",!0)],2)]))),128))])]}),_:1})}}}),Cs=C(Is,[["__scopeId","data-v-8ea55de3"]]);export{Cs as default};
