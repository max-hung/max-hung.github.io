import{_ as P}from"./CxT_KRz1.js";import{_ as q}from"./CgTTuqYx.js";import{_ as R}from"./_BektiU7.js";import{_ as W}from"./Dbuf_FDO.js";import{_ as Y}from"./d8r-YbsX.js";import{_ as z}from"./DRXWud6y.js";import{_ as F}from"./Dy6I-3M1.js";import{_ as G}from"./D1hBReYM.js";import{_ as J}from"./CiS6slKn.js";import{_ as X}from"./BDViKPFl.js";import{P as Z}from"./T4XvWNpB.js";import{c as ee,i as te,w as oe}from"./BTequ6KH.js";import{e as le,r as c,h as se,i as A,o as B,w as t,b as s,a as i,t as f,u as a,d,l as ae,c as ne,f as re,s as S}from"./CGtceNn1.js";import{u as ie}from"./BABWc3aM.js";import{f as ue}from"./DkQxb8LZ.js";import"./hPEqwt9r.js";const ce={class:"preview-block"},de={class:"flex lg:flex-row flex-col lg:justify-between justify-center items-center mb-5"},me={class:"flex lg:flex-row flex-col items-center lg:gap-2 lg:mb-0 mb-2"},pe={class:"flex lg:flex-row flex-col lg:gap-4 gap-y-2"},fe={class:"flex gap-1"},Ae=le({__name:"warehouse-items",setup(_e){ie({title:"Warehouse Items"});const H=c(null),I=c(0),h=c(""),k=c([]),b=c([]),g=c(!1),V=c([{key:"sku",label:"SKU"},{key:"title",label:"Item Title"},{key:"availableQty",label:"Available Qty"}]),U=async()=>{const{data:l}=await ee();b.value=l==null?void 0:l.stock},Q=()=>{g.value=!g.value,b.value=b.value.map(l=>({...l,selected:g.value&&!l.disabled})),k.value=g.value?b.value.filter(l=>!l.disabled):[]},L=l=>{k.value=l},E=async l=>{try{const e=l.target;if(!e||!e.files)throw new Error("File input is missing or invalid.");const r=e.files.item(0);if(!r)return;const u=await(n=>new Promise((_,p)=>{Z.parse(n,{encoding:"ISO-8859-1",download:!0,header:!0,skipEmptyLines:!0,complete:y=>{if(y.errors.length>0)p(y.errors);else{const w=y.data.map(K=>Object.fromEntries(Object.entries(K).map(([D,o])=>[D.trim(),typeof o=="string"?o.trim():o])));_(w)}},error:y=>p(y)})}))(r);await $(u)}catch(e){S({title:"Error !",content:e},"danger")}finally{I.value++}},$=async l=>{try{const{data:e}=await te({items:l});(e==null?void 0:e.errors.length)>0&&S({title:"Warning !",content:e==null?void 0:e.errors},"warning"),e!=null&&e.message&&S({title:"Success !",content:e==null?void 0:e.message},"success")}catch(e){S({title:"Error !",content:e},"danger")}finally{C(),U(),I.value++}},T=l=>l>0?"success":l===0?"danger":"light",x=c(!1),m=c({detail:{sku:"",title:"",availableQty:0},uk:[],hk:[]}),M=c([{label:"Status",key:"status"},{label:"Item Type",key:"itemType"},{label:"QTY",key:"qty"}]),N=c([{label:"Item ID",key:"itemId"},{label:"Item Type",key:"itemType"},{label:"Hold By Order",key:"holdByOrder"},{label:"Created Date",key:"createdAt"}]),O=async l=>{var _;const{sku:e,title:r,availableQty:v,warehouseStatus:u}=l;m.value.detail={sku:e,title:r,availableQty:v};const{data:n}=await oe({sku:l.sku});m.value.hk.push({status:"In stock",itemType:"Direct Line Item",qty:u.HK,date:""}),m.value.uk=(_=n==null?void 0:n.info)==null?void 0:_.items,m.value.uk.reverse()},j=()=>{const l=`SKU,Item Title,UK,HK,Available Qty
`,e=k.value.map(p=>`${p.sku},${p.title},${p.warehouseStatus.UK},${p.warehouseStatus.HK},${p.availableQty}`).join(`
`),r=l+e,v=new Blob([r],{type:"text/csv;charset=utf-8;"}),u=document.createElement("a"),n=URL.createObjectURL(v);u.href=n;const _=ue(new Date,"YYYYMMDD");u.setAttribute("download",`warehouse_items_${_}.csv`),document.body.appendChild(u),u.click(),document.body.removeChild(u),URL.revokeObjectURL(n)},C=()=>{x.value=!1,m.value={detail:{sku:"",title:"",availableQty:0},uk:[],hk:[]}};return se(()=>{U()}),(l,e)=>{const r=P,v=q,u=R,n=W,_=Y,p=z,y=F,w=G,K=J,D=X;return B(),A(D,null,{default:t(()=>[s(_,{title:"SKU Details","backdrop-close":!1,size:"full",visible:a(x),onClose:e[1]||(e[1]=o=>C())},{footer:t(()=>[s(n,{variant:"outline",color:"info",onClick:e[0]||(e[0]=o=>C())},{default:t(()=>e[11]||(e[11]=[d(" Close ")])),_:1})]),default:t(()=>[i("div",ce,[e[7]||(e[7]=i("div",null,"SKU",-1)),i("div",null,f(a(m).detail.sku),1),e[8]||(e[8]=i("div",null,"Item title",-1)),i("div",null,f(a(m).detail.title),1),e[9]||(e[9]=i("div",null,"Available Qty",-1)),i("div",null,f(a(m).detail.availableQty),1)]),s(u,{tabs:[{name:"uk",label:"UK"},{name:"hk",label:"HK"}]},{uk:t(()=>[s(v,{items:a(m).uk,headers:a(N)},{itemType:t(()=>[s(r,{color:"secondary"},{default:t(()=>e[10]||(e[10]=[d(" Local Item ")])),_:1})]),_:1},8,["items","headers"])]),hk:t(()=>[s(v,{items:a(m).hk,headers:a(M)},{status:t(({item:o})=>[s(r,{color:Number(o.qty)>0?"success":"dark"},{default:t(()=>[d(f(o.status),1)]),_:2},1032,["color"])]),itemType:t(({item:o})=>[s(r,{color:"primary"},{default:t(()=>[d(f(o.itemType),1)]),_:2},1024)]),_:1},8,["items","headers"])]),_:1})]),_:1},8,["visible"]),i("div",de,[i("div",me,[s(p,{modelValue:a(h),"onUpdate:modelValue":e[2]||(e[2]=o=>ae(h)?h.value=o:null),placeholder:"Search","icon-left":"icon-zoom"},null,8,["modelValue"])]),i("div",pe,[s(n,{color:"info",disabled:a(b).length==0,onClick:e[3]||(e[3]=o=>Q())},{default:t(()=>[d(f(a(g)?"Deselect All":"Select All"),1)]),_:1},8,["disabled"]),s(y,{class:"hidden lg:block"}),s(n,{color:"primary",variant:"outline",disabled:!a(k).length,class:"relative",onClick:e[4]||(e[4]=o=>j())},{icon:t(()=>[s(w,{class:"icon-download"})]),default:t(()=>[e[12]||(e[12]=d(" Download CSV ")),a(k).length?(B(),A(r,{key:0,color:"secondary",rounded:"",position:"top-right"},{default:t(()=>[d(f(a(k).length),1)]),_:1})):re("",!0)]),_:1},8,["disabled"]),(B(),ne("input",{type:"file",accept:".csv",ref_key:"fileInput",ref:H,onChange:e[5]||(e[5]=o=>E(o)),key:a(I),hidden:""},null,32)),s(n,{size:"md",onClick:e[6]||(e[6]=o=>$())},{icon:t(()=>[s(w,{class:"icon-cloud-upload"})]),default:t(()=>[e[13]||(e[13]=d(" Import Demo "))]),_:1})])]),s(K,{items:a(b),"search-query":a(h),headers:a(V),selectable:"",onSelectItems:L},{header:t(()=>e[14]||(e[14]=[i("div",{class:"text-gray-950 text-base font-medium"}," Browse Warehouse Items ",-1)])),warehouseStatus:t(({item:o})=>[i("div",fe,[s(r,{color:T(o.warehouseStatus.UK)},{default:t(()=>[d(" UK:"+f(o.warehouseStatus.UK),1)]),_:2},1032,["color"]),s(r,{color:T(o.warehouseStatus.HK)},{default:t(()=>[d(" HK:"+f(o.warehouseStatus.HK),1)]),_:2},1032,["color"])])]),itemDetail:t(({item:o})=>[s(n,{color:"info",variant:"outline",onClick:ve=>(x.value=!0,O(o))},{icon:t(()=>[s(w,{class:"icon-edit"})]),default:t(()=>[e[15]||(e[15]=d(" Detail "))]),_:2},1032,["onClick"])]),_:1},8,["items","search-query","headers"])]),_:1})}}});export{Ae as default};
