import{_ as se}from"./Dbuf_FDO.js";import{_ as oe}from"./d8r-YbsX.js";import{_ as ae}from"./2ZmZbizh.js";import{_ as re}from"./0UsyiB6R.js";import{_ as le}from"./kvZzMBT0.js";import{_ as ie}from"./D1hBReYM.js";import{_ as ne}from"./CeFBEpB1.js";import{_ as de}from"./DRXWud6y.js";import{_ as ue}from"./CgTTuqYx.js";import{_ as ce}from"./BHurczZ2.js";import{_ as pe}from"./BDViKPFl.js";import{e as me,r as l,j as fe,C as j,J as ve,i as O,o as k,w as n,b as r,a as o,d as f,u as t,l as J,n as C,K as _e,f as B,t as K,H as ge,I as ye,c as R,s as E}from"./CGtceNn1.js";import{a as ke,b as xe}from"./BTequ6KH.js";import{u as be}from"./CWpighah.js";import{u as Se}from"./BABWc3aM.js";import{f as Ce}from"./DkQxb8LZ.js";import"./CpTSz9em.js";import"./CxT_KRz1.js";import"./CtYZZ1AZ.js";const we={class:"flex gap-2"},Ie={class:"grid grid-cols-1 lg:grid-cols-2 gap-4"},Le={class:"flex flex-col gap-4"},he={class:"grid grid-cols-2 gap-4"},De={class:"flex flex-col justify-center items-center"},Ne={class:"flex flex-col justify-center items-center"},Oe={class:"flex justify-between items-end"},Pe={class:"text-gray-500 text-xs flex gap-1"},Ae={class:"overflow-auto col-span-2 max-h-[400px]"},Te={class:"overflow-auto max-h-[400px] border-l"},Be={class:"flex justify-between items-center hover:bg-gray-100 rounded-lg p-2"},Ke=["src"],$e={key:1,class:"p-4 text-center text-gray-400"},at=me({__name:"sku-to-print",setup(Ue){const{generateQRCodes:q,imageUrls:v}=be();Se({title:"SKU To Print"});const H=Ce(new Date,"YYYY-MM-DD"),w=l(H),d=l([]),$=localStorage.getItem("skipList");if($)try{d.value=JSON.parse($)}catch(s){console.error("Failed to parse skipList from localStorage:",s),d.value=[]}const Q=l([{label:"Skip List",key:"skipList"}]),p=l(""),z=l([]),U=l(null),I=l(!1),V=l(null),F=l([{key:"sku",label:"SKU",sort:!0},{key:"qty",label:"Total(QTY)",sort:!0},{key:"remains",label:"Remaining to find",sort:!0}]),L=l([]),_=l(""),h=l(!1),P=l({trackingCode:"",orderId:""}),D=l(!1),W=fe(()=>Array.isArray(d.value)?d.value.map(s=>s.skipList):[]),g=l(""),G=async()=>{if(_.value){v.value[0]="";try{const s=i.value?ke:xe,e={sku:_.value,date:w.value,...i.value?{}:{skippedOrders:W.value,trackingCode:g.value}},{data:a,error:c}=await s(e);if(c!=null&&c.message){D.value=!0,M("Warning !",c.message);return}if(a.info){const x=i.value?a.info:a.info[0],{sku:b,qty:S,trackingCode:m,updatedAt:y,orderItemId:A,orderId:N}=x;z.value=i.value?[A]:a.info.flatMap(T=>T.orderItemIds),p.value=i.value?N:a.orderId,g.value=m,h.value=a.isDone||!1,L.value=i.value?[{sku:b,qty:S,remains:S}]:a.info,q([{trackingId:m,sku:a.info.length>1?"":b,qty:S,updatedDate:y}])}if(!U.value||!v.value.length)return}catch(s){M("Error !",s)}finally{_.value=""}}},M=(s,e)=>{E({title:s,content:e},s==="Warning !"?"warning":"danger")},X=()=>{if(!p.value)return;d.value.push({skipList:p.value});const s=Array.from(new Set(d.value.map(e=>JSON.stringify(e)))).map(e=>JSON.parse(e));d.value=s,localStorage.setItem("skipList",JSON.stringify(d.value)),p.value="",g.value="",L.value=[]},Z=s=>{const e=localStorage.getItem("skipList");if(e)try{const a=JSON.parse(e);if(!Array.isArray(a))return;const c=a.filter(x=>x.skipList!==s);localStorage.setItem("skipList",JSON.stringify(c)),d.value=c}catch{E({title:"Error !",content:"Invalid skipList data format."},"danger")}},ee=s=>{I.value=s},i=l(!0),Y=s=>{i.value=s};return j(()=>i.value,()=>{v.value[0]="",L.value=[],p.value="",g.value="",P.value={trackingCode:"",orderId:""},h.value=!1}),j(()=>I.value,async s=>{var e,a;s&&(await ve(),(a=(e=V.value)==null?void 0:e.inputElement)==null||a.focus())}),(s,e)=>{const a=se,c=oe,x=ae,b=re,S=le,m=ie,y=ne,A=de,N=ue,T=ce,te=pe;return k(),O(te,null,{default:n(()=>[r(c,{title:"SKU Not Found","backdrop-close":!1,visible:t(D),onClose:e[1]||(e[1]=u=>D.value=!1)},{footer:n(()=>[o("div",we,[r(a,{color:"primary",onClick:e[0]||(e[0]=u=>D.value=!1)},{default:n(()=>e[6]||(e[6]=[f(" OK ")])),_:1})])]),default:n(()=>[e[7]||(e[7]=f(" This SKU is not in the list, please scan again. "))]),_:1},8,["visible"]),r(x,{ref_key:"refPrinter",ref:U,onSetupCompleted:ee},null,512),o("div",Ie,[r(y,{class:C([!t(I)&&"disabled-card"])},{header:n(()=>[r(b,null,{default:n(()=>e[8]||(e[8]=[o("div",{class:"flex justify-start items-center h-[38px]"},[o("div",null,"Basic Settings")],-1)])),_:1})]),default:n(()=>[o("div",Le,[r(S,{label:"Date",modelValue:t(w),"onUpdate:modelValue":e[2]||(e[2]=u=>J(w)?w.value=u:null),range:!1,"value-type":"YYYY-MM-DD",class:"md:m-0 mb-2 min-w-[49%]"},null,8,["modelValue"]),e[14]||(e[14]=f(" Type ")),o("div",he,[r(y,{class:C([t(i)?"bg-primary4! border-primary2 text-primary-dark":"bg-gray-100! border-gray-300 text-gray-500"]),onClick:e[3]||(e[3]=u=>Y(!0))},{default:n(()=>[o("div",De,[r(m,{class:"icon-simple text-xl opacity-70"}),e[9]||(e[9]=o("div",null,"Simple Pack",-1)),e[10]||(e[10]=o("div",{class:"opacity-70"},"one to one",-1))])]),_:1},8,["class"]),r(y,{class:C([t(i)?"bg-gray-100! border-gray-300 text-gray-500":"bg-primary4! border-primary2 text-primary-dark"]),onClick:e[4]||(e[4]=u=>Y(!1))},{default:n(()=>[o("div",Ne,[r(m,{class:"icon-complex text-xl opacity-70"}),e[11]||(e[11]=o("div",null,"Complex Pack",-1)),e[12]||(e[12]=o("div",{class:"opacity-70"},"multiple Items",-1))])]),_:1},8,["class"])]),r(A,{ref_key:"inputRef",ref:V,modelValue:t(_),"onUpdate:modelValue":e[5]||(e[5]=u=>J(_)?_.value=u:null),modelModifiers:{trim:!0},placeholder:"Please scan the SKU",disabled:!t(I),label:"SKU",onKeydown:_e(G,["enter"])},null,8,["modelValue","disabled"]),o("div",Oe,[o("div",Pe,[t(g)?(k(),O(m,{key:0,class:"icon-box"})):B("",!0),f(" "+K(t(g)||t(P).trackingCode)+" ",1),t(p)?(k(),O(m,{key:1,class:"icon-page"})):B("",!0),f(" "+K(t(p)||t(P).orderId),1)]),t(i)?B("",!0):(k(),O(a,{key:0,color:"secondary",size:"xs",onClick:X,disabled:!t(p)},{default:n(()=>e[13]||(e[13]=[f(" Skip ")])),_:1},8,["disabled"]))]),o("div",{class:C(["border rounded-lg overflow-auto",{"grid grid-cols-3":!t(i)}])},[o("div",Ae,[r(N,{items:t(L),headers:t(F)},null,8,["items","headers"])]),ge(o("div",Te,[r(N,{items:t(d),headers:t(Q),hover:!1},{skipList:n(({item:u})=>[o("div",Be,[f(K(u.skipList)+" ",1),r(m,{class:"icon-hide cursor-pointer",onClick:Ve=>Z(u.skipList)},null,8,["onClick"])])]),_:1},8,["items","headers"])],512),[[ye,!t(i)]])],2)])]),_:1},8,["class"]),r(y,null,{header:n(()=>[r(b,null,{default:n(()=>e[15]||(e[15]=[o("div",{class:"flex justify-between items-center"},[o("div",null,"Preview")],-1)])),_:1})]),default:n(()=>[r(T,{color:"primary",visible:!t(i)&&t(v)[0]!=""&&!t(h)},{default:n(()=>e[16]||(e[16]=[f(" All remaining items must be identified before the shipping label can be printed. ")])),_:1},8,["visible"]),t(v)[0]?(k(),R("img",{key:0,src:t(v)[0],alt:"",class:C([!t(h)&&!t(i)?"opacity-50":"opacity-100"])},null,10,Ke)):(k(),R("div",$e,"No Data"))]),_:1})])]),_:1})}}});export{at as default};
