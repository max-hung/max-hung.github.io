import{_ as ne}from"./Dfp7AvXi.js";import{e as z,c as j,o as y,d,a as u,t as E,n as ae,_ as re,r as c,j as M,h as ie,i as h,w as o,s as f,b as n,u as a,l as N,g as L,F as P}from"./Dyj2WlPb.js";import{_ as ue}from"./DGaLc6hS.js";import{_ as ce}from"./DRZCxZ05.js";import{_ as de}from"./BDMdXTfd.js";import{_ as me}from"./BJtdx8Bp.js";import{_ as fe}from"./DjfhUWZR.js";import{_ as pe}from"./sizKiCXL.js";import{_ as ve}from"./BkQcq6wg.js";import{_ as _e}from"./t_gq4Wqv.js";import{f as A}from"./671f6edt.js";import{r as be,c as ge,e as ye,d as Se}from"./sGGVUJeg.js";import{m as q}from"./BWFg95Bt.js";import{u as ke}from"./B_6WcIZr.js";const we={class:"flex flex-col gap-y-1"},xe=["checked","disabled"],Ce=z({__name:"BaseSwitch",props:{modelValue:{type:[String,Number,Boolean],required:!0},label:{type:[String,Number,Boolean],default:""},disabled:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(S){const b=S;return(p,m)=>(y(),j("div",we,[d(E(b.label)+" ",1),u("label",{class:ae(["switch",{"opacity-50 pointer-events-none":S.disabled}])},[u("input",{type:"checkbox",checked:S.modelValue,onChange:m[0]||(m[0]=k=>p.$emit("update:modelValue",k.target.checked)),disabled:S.disabled},null,40,xe),m[1]||(m[1]=u("span",{class:"slider round"},null,-1))],2)]))}}),Ve=re(Ce,[["__scopeId","data-v-05363fa2"]]),$e={class:"flex flex-col gap-4"},Be={class:"grid grid-cols-3 items-center"},Re={class:"pl-8"},he={class:"flex gap-2"},Ae={class:"flex gap-2"},je={class:"flex lg:flex-row flex-col lg:justify-between justify-center items-center mb-5"},Ee={class:"flex flex-row gap-1"},De={class:"flex flex-wrap gap-4"},Ke=z({__name:"roles",setup(S){ke({title:"Roles"});const b=c(""),p=c(!1),m=c(!1),k=c(!1),D=c([]),g=c(""),r=c([]),w=c(0),x=c(q.reduce((e,l)=>(e[l.label]=!1,e),{})),C=M(()=>[{label:"Admin",roles:["all"]},...q.filter(e=>e.roles&&e.label!=="Dashboard").map(e=>({label:e.label,roles:Array.isArray(e.roles)?e.roles:[e.roles]}))]),F=c([{key:"title",label:"Title",sort:!0},{key:"subject",label:"Subject",sort:!0},{key:"edit",label:"Action",style:"w-[200px]"}]),G=(e,l)=>{x.value[e]=l;const s=C.value.find(V=>V.label===e);s&&(l?r.value=Array.from(new Set([...r.value,...s.roles])):r.value=r.value.filter(V=>!s.roles.includes(V)))},H=(e,l)=>{l?r.value.includes(e)||r.value.push(e):r.value=r.value.filter(s=>s!==e),O(e)},O=e=>{const l=C.value.find(s=>s.roles.includes(e));l&&(x.value[l.label]=l.roles.every(s=>r.value.includes(s)))},J=e=>{const l=C.value.find(s=>s.label===e);return l?l.roles.every(s=>r.value.includes(s)):!1},$=async()=>{try{const{data:e}=await be();e!=null&&e.list&&(D.value=e.list)}catch(e){f({title:"Error !",content:e},"danger")}},B=()=>{C.value.forEach(e=>{x.value[e.label]=J(e.label)})},K=e=>{m.value=!0,g.value=e.title,w.value=e.id,r.value=[...e.subject],B()},Q=e=>{k.value=!0,p.value=!1,w.value=e.id},I=M(()=>({id:w.value,title:g.value,action:"manage",subject:r.value.join()})),W=async()=>{try{const{data:e}=await ge(I.value);e!=null&&e.message&&f({title:"Success !",content:e==null?void 0:e.message},"success")}catch(e){f({title:"Error !",content:e},"danger")}finally{$(),v()}},X=async()=>{try{const{data:e}=await ye(I.value);e!=null&&e.message&&f({title:"Success !",content:e==null?void 0:e.message},"success")}catch(e){f({title:"Error !",content:e},"danger")}finally{$(),v()}},Y=async()=>{try{const{data:e,error:l}=await Se({id:w.value});if(l!=null&&l.message){f({title:"Error !",content:l.message},"danger");return}e!=null&&e.message&&f({title:"Success !",content:e==null?void 0:e.message},"success")}catch(e){f({title:"Error !",content:e},"danger")}finally{$(),v()}},v=()=>{m.value=!1,k.value=!1,p.value=!1,g.value="",r.value=[],w.value=0,B()};return ie(()=>{$(),B()}),(e,l)=>{const s=ne,V=Ve,Z=ue,ee=ce,_=de,U=me,T=fe,le=pe,te=ve,oe=_e;return y(),h(oe,null,{default:o(()=>[n(U,{size:"lg",title:a(p)?"Create User":"Edit User","backdrop-close":!1,visible:a(m),onClose:l[2]||(l[2]=t=>v()),onSubmit:l[3]||(l[3]=t=>a(p)?W():X())},{footer:o(()=>[u("div",he,[n(_,{variant:"outline",color:"info",onClick:l[1]||(l[1]=t=>v())},{default:o(()=>l[9]||(l[9]=[d(" Close ")])),_:1}),n(_,{color:"primary",type:"submit"},{default:o(()=>l[10]||(l[10]=[d("Save Changes")])),_:1})])]),default:o(()=>[u("div",$e,[n(s,{label:"Title",modelValue:a(g),"onUpdate:modelValue":l[0]||(l[0]=t=>N(g)?g.value=t:null),placeholder:"Title",class:"w-full"},null,8,["modelValue"]),n(ee,{items:a(C),headers:[{key:"label",label:"Subject",sort:!0},{key:"roles",label:"",hidden:!0}]},{label:o(({item:t})=>[u("div",Be,[n(V,{modelValue:a(x)[t.label],"onUpdate:modelValue":[i=>a(x)[t.label]=i,i=>G(t.label,i)],label:t.label},null,8,["modelValue","onUpdate:modelValue","label"]),u("div",Re,[(y(!0),j(P,null,L(t.roles,(i,R)=>(y(),h(Z,{key:R,label:("formatString"in e?e.formatString:a(A))(String(i)),"model-value":a(r).includes(String(i)),"onUpdate:modelValue":se=>H(String(i),se)},null,8,["label","model-value","onUpdate:modelValue"]))),128))])])]),_:1},8,["items"])])]),_:1},8,["title","visible"]),n(U,{title:"Delete Role","backdrop-close":!1,visible:a(k),onClose:l[5]||(l[5]=t=>v()),onSubmit:l[6]||(l[6]=t=>Y())},{footer:o(()=>[u("div",Ae,[n(_,{variant:"outline",color:"info",onClick:l[4]||(l[4]=t=>v())},{default:o(()=>l[11]||(l[11]=[d(" Cancel ")])),_:1}),n(_,{color:"danger",type:"submit"},{default:o(()=>l[12]||(l[12]=[d("Delete")])),_:1})])]),default:o(()=>[l[13]||(l[13]=d(" Are you sure you want to delete this role? "))]),_:1},8,["visible"]),u("div",je,[n(s,{modelValue:a(b),"onUpdate:modelValue":l[7]||(l[7]=t=>N(b)?b.value=t:null),placeholder:"Search","icon-left":"icon-zoom"},null,8,["modelValue"]),n(_,{color:"primary",class:"relative",onClick:l[8]||(l[8]=t=>(m.value=!0,p.value=!0))},{default:o(()=>l[14]||(l[14]=[d(" Create Role ")])),_:1})]),n(te,{"search-query":a(b),items:a(D),headers:a(F)},{edit:o(({item:t})=>[u("div",Ee,[n(_,{color:"info",variant:"outline",onClick:i=>K(t)},{icon:o(()=>[n(T,{class:"icon-edit"})]),default:o(()=>[l[15]||(l[15]=d(" Edit "))]),_:2},1032,["onClick"]),n(_,{color:"danger",onClick:i=>Q(t)},{default:o(()=>[n(T,{class:"icon-trash"})]),_:2},1032,["onClick"])])]),title:o(({item:t})=>[d(E(("formatString"in e?e.formatString:a(A))(t.title)),1)]),subject:o(({item:t})=>[u("div",De,[(y(!0),j(P,null,L(t.subject,(i,R)=>(y(),h(le,{key:R,color:"primary"},{default:o(()=>[d(E(("formatString"in e?e.formatString:a(A))(i)),1)]),_:2},1024))),128))])]),_:1},8,["search-query","items","headers"])]),_:1})}}});export{Ke as default};
