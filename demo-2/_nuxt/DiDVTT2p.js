import{_ as E}from"./nVl-3sKa.js";import{_ as G}from"./82EDPpRA.js";import{_ as P}from"./bW2h9BDD.js";import{_ as j}from"./DiwpcSc5.js";import{_ as N}from"./lSsI-1dM.js";import{x as C,e as H,r as n,h as K,i as O,o as v,w as c,s as b,a as u,b as m,u as a,l as U,c as q,d as A}from"./BWmc6sBk.js";import{P as F}from"./Uv0iLqzw.js";import{u as M}from"./IQ7qW07a.js";import"./t5m8x_TL.js";async function $(l){return await C.get("/listing/global-listing",l)}async function z(l){return await C.post("/listing/global-listing",l)}const R={class:"flex lg:flex-row flex-col lg:justify-between justify-center items-center mb-5"},T={class:"flex lg:flex-row flex-col lg:justify-between items-center lg:gap-2 lg:mb-0 mb-2"},W={class:"flex flex-row gap-4"},se=H({__name:"global-listing",setup(l){M({title:"Global Listing"});const r=n(""),x=n([]),p=n(null),I=n([{key:"sku",label:"SKU",sort:!0},{key:"productCost",label:"Cost (HKD)",sort:!0},{key:"name",label:"Item title",sort:!0},{key:"weight",label:"Weight (kg)",sort:!0}]),w=async()=>{try{const{data:t}=await $();x.value=(t==null?void 0:t.list)||[]}catch(t){b({title:"Error !",content:t},"danger")}},V=()=>{f.value=null,p.value&&p.value.click()},f=n(null),h=n(0),B=async t=>{try{const e=t.target.files.item(0),d=await(_=>new Promise((g,o)=>{F.parse(_,{encoding:"ISO-8859-1",download:!0,header:!0,skipEmptyLines:!0,complete:s=>{if(s.errors.length>0)o(s.errors);else{const L=s.data.map(S=>Object.fromEntries(Object.entries(S).map(([D,y])=>[D.trim(),typeof y=="string"?y.trim():y])));g(L)}},error:s=>o(s)})}))(e);f.value=d;const{data:i}=await z(f.value);i&&b({title:"Success !",content:i.message},"success")}catch(e){b({title:"Error !",content:e},"danger")}finally{h.value++,w()}};return K(async()=>{await w()}),(t,e)=>{const k=E,d=G,i=P,_=j,g=N;return v(),O(g,null,{default:c(()=>[u("div",R,[u("div",T,[m(k,{modelValue:a(r),"onUpdate:modelValue":e[0]||(e[0]=o=>U(r)?r.value=o:null),placeholder:"Search","icon-left":"icon-zoom"},null,8,["modelValue"])]),u("div",W,[m(i,{color:"primary",class:"relative",onClick:V},{icon:c(()=>[m(d,{class:"icon-cloud-upload"})]),default:c(()=>[e[2]||(e[2]=A(" Create Listing (CSV) "))]),_:1}),(v(),q("input",{type:"file",accept:".csv",ref_key:"fileInput",ref:p,onChange:e[1]||(e[1]=o=>B(o)),key:a(h),hidden:""},null,32))])]),m(_,{items:a(x),"search-query":a(r),headers:a(I)},{header:c(()=>e[3]||(e[3]=[u("div",{class:"text-gray-950 text-base font-medium"},"Global Listing",-1)])),_:1},8,["items","search-query","headers"])]),_:1})}}});export{se as default};
