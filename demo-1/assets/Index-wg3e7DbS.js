import{i as E,g as c,x as oe,m as N,n as j,r as t,o as C,c as B,a as e,w as l,h as p,j as O,F as D,y as te,z as se,t as T,d as F,b as $,e as L,A as ne,B as re,v as ue,u as H}from"./index-jOY3Yhej.js";const de={__name:"CreateUser",setup(P){const V=E("reload"),s=c({name:"",email:"",roleId:[],password:"",clientId:"0"}),m=E("$toast"),y=c([]);c([{label:"Choose...",value:"0"}]);const U=c(!1),f=c(!1);oe(U,i=>{if(i)return s.value.clientId="1"}),N(()=>{b()});async function b(){try{(await j()).data.list.forEach(n=>{y.value.push({text:n.title,value:n.id})})}catch(i){m.error(i.message)}}async function u(){try{const{data:i}=await te(s.value);m.success(i.message)}catch(i){m.error(i.response.data.message)}finally{s.value.email="",s.value.name="",s.value.password="",V()}}function M(i){let n=[];i.forEach(w=>{n.push(w.value)}),s.value.roleId=n}return(i,n)=>{const w=t("CButton"),k=t("CModalTitle"),R=t("CModalHeader"),x=t("CFormInput"),v=t("CCol"),S=t("CMultiSelect"),z=t("CRow"),a=t("CForm"),o=t("CModalBody"),_=t("CModal");return C(),B(D,null,[e(w,{variant:"outline",color:"primary",onClick:n[0]||(n[0]=()=>{f.value=!0})},{default:l(()=>[p(" Create User ")]),_:1}),e(_,{backdrop:"static",visible:f.value,onClose:n[6]||(n[6]=()=>{f.value=!1})},{default:l(()=>[e(R,null,{default:l(()=>[e(k,null,{default:l(()=>[p("Create User")]),_:1})]),_:1}),e(o,null,{default:l(()=>[e(a,{class:"row gy-2 gx-3 align-items-center",onSubmit:O(u,["prevent"])},{default:l(()=>[e(z,{xs:{cols:1,gutter:2},md:{cols:1,gutter:2},xxl:{cols:1,gutter:2}},{default:l(()=>[e(v,null,{default:l(()=>[e(x,{type:"email",id:"emailInput",floatingLabel:"Email address",modelValue:s.value.email,"onUpdate:modelValue":n[1]||(n[1]=d=>s.value.email=d),autocomplete:"off",required:""},null,8,["modelValue"])]),_:1}),e(v,null,{default:l(()=>[e(x,{type:"name",floatingLabel:"User name",modelValue:s.value.name,"onUpdate:modelValue":n[2]||(n[2]=d=>s.value.name=d),autocomplete:"off",required:""},null,8,["modelValue"])]),_:1}),e(v,null,{default:l(()=>[e(x,{type:"password",floatingLabel:"Password",modelValue:s.value.password,"onUpdate:modelValue":n[3]||(n[3]=d=>s.value.password=d),autocomplete:"new-password",required:""},null,8,["modelValue"])]),_:1}),e(v,null,{default:l(()=>[e(S,{placeholder:"Role",size:"lg",options:y.value,onChange:n[4]||(n[4]=d=>M(d)),modelValue:s.value.roleId,"onUpdate:modelValue":n[5]||(n[5]=d=>s.value.roleId=d)},null,8,["options","modelValue"])]),_:1}),e(v,null,{default:l(()=>[e(w,{size:"lg",color:"primary",type:"submit"},{default:l(()=>[p(" Create ")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["visible"])],64)}}},ie={class:"py-2"},ce={class:"d-grid gap-2 d-md-flex justify-content-md-end"},me=L("hr",null,null,-1),pe={__name:"UserList",setup(P){const{proxy:V}=ue(),s=E("$toast"),m=c(!1),y=c([{key:"name",_props:{color:"primary",class:"fw-semibold"}},{key:"email",_props:{color:"primary",class:"fw-semibold"}},{key:"clientCode",label:"Client Code",_props:{color:"primary",class:"fw-semibold"}},{key:"roleList",label:"Role List",_props:{color:"primary",class:"fw-semibold"}},{key:"createdAt",_props:{color:"primary",class:"fw-semibold"}},{key:"show_details",label:"",_style:{width:"1%"},filter:!1,sorter:!1,_props:{color:"primary",class:"fw-semibold"}}]),U=c([]),f=c([]),b=c([]),u=c({id:"",name:"",email:"",roleId:[],password:"",clientId:""}),M=c(0),i=c(!0),n=c(!1);N(()=>{k(),w()});async function w(){try{(await j()).data.list.forEach(o=>{b.value.push({text:o.title,value:o.id})})}catch(a){s.error(a.message)}}function k(){se().then(a=>{i.value=!1,m.value=!1,U.value=a.data.list,M.value++},a=>{s.error(a.message)})}function R(){ne(u.value).then(a=>{k(),s.success(a.data.message)},a=>{s.error(a.message)})}function x(a){n.value=!1;let o=[];a.roleList.forEach(_=>{o.push(_.roleId)}),b.value.forEach(_=>{delete _.selected}),b.value.filter(_=>{o.includes(_.value)&&(_.selected=!0)}),a.clientId!==""?n.value=!0:a.clientId="1",u.value={id:a.id,name:a.name,email:a.email,roleId:o,paaasword:"",clientId:String(a.clientId)}}function v(a){if(u.value.roleId.includes(a)){var o=u.value.roleId.indexOf(a);o!==-1&&u.value.roleId.splice(o,1)}else u.value.roleId.push(a);if(u.value.roleId.length==0){u.value.roleId=[];return}}function S(a){if(f.value.includes(a._id)){f.value=f.value.filter(o=>o!==a._id);return}f.value.push(a._id)}function z(a){V.$vueAlert.confirm("Do you really want to delete?").then(()=>{re().then(o=>{k(),s.success(o.data.message)},o=>{s.error(o.response.data.message)})}).catch(()=>{s.default("Cancel")})}return(a,o)=>{const _=t("CBadge"),d=t("CButton"),q=t("CCardBody"),G=t("CCollapse"),J=t("CSmartTable"),K=t("CCard"),Q=t("CModalTitle"),W=t("CModalHeader"),h=t("CFormInput"),g=t("CCol"),X=t("CFormCheck"),Y=t("CRow"),Z=t("CModalBody"),ee=t("CModalFooter"),le=t("CForm"),ae=t("CModal");return C(),B(D,null,[e(K,null,{default:l(()=>[e(q,null,{default:l(()=>[(C(),F(J,{clickableRows:"",key:M.value,tableProps:{striped:!0,hover:!0,responsive:!0},tableHeadProps:{color:"danger"},activePage:1,header:"",items:U.value,columns:y.value,columnFilter:"",loading:i.value,tableFilter:"",cleaner:"",itemsPerPageSelect:"",itemsPerPage:20,columnSorter:"",sorterValue:{column:"status",state:"asc"},pagination:""},{roleList:l(({item:r})=>[L("td",null,[(C(!0),B(D,null,$(r.roleList,(I,A)=>(C(),F(_,{class:"me-2",xs:"4",color:"info",key:A},{default:l(()=>[p(T(I.title),1)]),_:2},1024))),128))])]),show_details:l(({item:r,index:I})=>[L("td",ie,[e(d,{color:"primary",variant:"outline",square:"",size:"sm",onClick:A=>S(r,I)},{default:l(()=>[p(T(r._toggled?"Hide":"Show"),1)]),_:2},1032,["onClick"])])]),details:l(({item:r})=>[e(G,{visible:f.value.includes(r._id)},{default:l(()=>[e(q,null,{default:l(()=>[L("div",ce,[e(d,{size:"sm",color:"info",onClick:()=>{m.value=!0,x(r)}},{default:l(()=>[p(" User Settings ")]),_:2},1032,["onClick"]),e(d,{size:"sm",color:"danger",class:"ml-1",onClick:I=>z(r.id)},{default:l(()=>[p(" Delete ")]),_:2},1032,["onClick"])])]),_:2},1024)]),_:2},1032,["visible"])]),_:1},8,["items","columns","loading"]))]),_:1})]),_:1}),e(ae,{backdrop:"static",visible:m.value,onClose:o[5]||(o[5]=()=>{m.value=!1})},{default:l(()=>[e(W,null,{default:l(()=>[e(Q,null,{default:l(()=>[p("Edit")]),_:1})]),_:1}),e(le,{onSubmit:O(R,["prevent"])},{default:l(()=>[e(Z,null,{default:l(()=>[e(g,{xs:"auto",class:"mb-3",hidden:""},{default:l(()=>[e(h,{floatingLabel:"ID",type:"text",size:"lg",modelValue:u.value.id,"onUpdate:modelValue":o[0]||(o[0]=r=>u.value.id=r),required:""},null,8,["modelValue"])]),_:1}),e(g,{xs:"auto",class:"mb-3"},{default:l(()=>[e(h,{floatingLabel:"Name",type:"text",size:"lg",modelValue:u.value.name,"onUpdate:modelValue":o[1]||(o[1]=r=>u.value.name=r),required:""},null,8,["modelValue"])]),_:1}),e(g,{xs:"auto",class:"mb-3"},{default:l(()=>[e(h,{floatingLabel:"Email",type:"email",size:"lg",modelValue:u.value.email,"onUpdate:modelValue":o[2]||(o[2]=r=>u.value.email=r),required:""},null,8,["modelValue"])]),_:1}),e(g,{xs:"auto",class:"mb-3"},{default:l(()=>[e(h,{floatingLabel:"password",type:"password",size:"lg",modelValue:u.value.password,"onUpdate:modelValue":o[3]||(o[3]=r=>u.value.password=r),text:"Password no required"},null,8,["modelValue"])]),_:1}),e(g,{class:"mb-3"}),e(g,null,{default:l(()=>[p(" Role: "),me]),_:1}),e(Y,null,{default:l(()=>[(C(!0),B(D,null,$(b.value,(r,I)=>(C(),F(g,{md:"4",class:"mb-3",key:I},{default:l(()=>[e(X,{checked:r.selected,label:r.text,value:r.value,onClick:A=>v(r.value)},null,8,["checked","label","value","onClick"])]),_:2},1024))),128))]),_:1})]),_:1}),e(ee,null,{default:l(()=>[e(d,{color:"secondary",onClick:o[4]||(o[4]=()=>{m.value=!1})},{default:l(()=>[p(" Close ")]),_:1}),e(d,{color:"primary",type:"submit"},{default:l(()=>[p("Save changes")]),_:1})]),_:1})]),_:1})]),_:1},8,["visible"])],64)}}},fe={__name:"Index",setup(P){return(V,s)=>{const m=t("CCol"),y=t("CRow");return C(),F(y,{xs:{cols:1},md:{cols:1},xxl:{cols:1}},{default:l(()=>[e(m,null,{default:l(()=>[e(H(de))]),_:1}),e(m,{class:"mt-2"},{default:l(()=>[e(H(pe))]),_:1})]),_:1})}}};export{fe as default};
