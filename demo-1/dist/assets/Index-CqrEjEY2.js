import{i as T,g as m,r as a,o as C,c as U,a as e,w as t,h as d,j as S,e as r,d as $,f as R,T as Z,F,X as J,m as K,Y as O,Z as B,u as v,t as g,$ as W,a0 as ee,v as te}from"./index-AqC2jWHn.js";const ae={class:"d-grid gap-2 d-md-flex justify-content-md-end"},le={__name:"CreateClient",setup(P){const f=T("$toast"),u=T("reload"),i=m({id:"",clientCode:""}),c=m(!1);async function w(){try{const{data:p}=await J(i.value);f.success(p.message)}catch(p){f.error(p.message)}finally{u()}}return(p,_)=>{const s=a("CButton"),y=a("CInputGroupText"),h=a("CFormInput"),V=a("CInputGroup"),k=a("CCol"),n=a("CRow"),o=a("CForm"),L=a("CCardBody"),I=a("CCard");return C(),U(F,null,[e(s,{color:"info",class:"mb-2",variant:"outline",onClick:_[0]||(_[0]=b=>c.value=!c.value)},{default:t(()=>[d(" Register Client ")]),_:1}),e(Z,{duration:"550",name:"nested"},{default:t(()=>[c.value?(C(),$(L,{key:0},{default:t(()=>[e(I,null,{default:t(()=>[e(L,null,{default:t(()=>[e(o,{class:"row gy-2 align-items-center",onSubmit:S(w,["prevent"])},{default:t(()=>[e(n,{xs:{cols:1,gutter:2},xxl:{cols:2,gutter:2}},{default:t(()=>[e(k,{class:"mt-2"},{default:t(()=>[e(V,null,{default:t(()=>[e(y,null,{default:t(()=>[d("Client Code")]),_:1}),e(h,{modelValue:i.value.clientCode,"onUpdate:modelValue":_[1]||(_[1]=b=>i.value.clientCode=b),required:""},null,8,["modelValue"])]),_:1})]),_:1}),r("div",ae,[e(s,{color:"primary",type:"submit"},{default:t(()=>[d("Submit")]),_:1})])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})):R("",!0)]),_:1})],64)}}},oe=r("strong",null,"Client List",-1),ne={class:"clearfix"},se={class:"float-start"},ie={class:"float-end"},re={class:"text-medium-emphasis"},ue={class:"py-2"},de={key:0,class:"d-grid gap-2 d-md-flex justify-content-md-end"},ce=r("hr",{class:"mt-2"},null,-1),me={class:"d-grid gap-2 d-md-flex justify-content-md-end"},pe={__name:"ClientList",setup(P){const{proxy:f}=te(),u=T("$toast"),i=m(!1),c=m(!1),w=m([{key:"clientCode",label:"Client Name",sorter:!1,_props:{color:"primary",class:"fw-semibold"}},{key:"apiUsage",label:"Request Quota - Left / Max",sorter:!1,_props:{color:"primary",class:"fw-semibold"}},{key:"date",label:"Last Updated",_style:{width:"20%"},sorter:!1,_props:{color:"primary",class:"fw-semibold"}},{key:"action",label:"",sorter:!1,_style:{width:"1%"},_props:{color:"primary",class:"fw-semibold"}}]),p=m([]),_=m(0),s=m({});K(()=>{y()});async function y(){try{const{data:n}=await O();p.value=n.list}catch(n){u.error(n.message)}finally{c.value=!1,_.value++,i.value=!1}}function h(n){s.value={id:n.id,clientCode:n.clientCode,apiDailyLimit:{maxLimit:n.apiDailyLimit.maxLimit,apiUsageLeft:n.apiDailyLimit.apiUsageLeft}}}function V(n){f.$vueAlert.confirm("Do you really want to delete?").then(async()=>{try{const{data:o}=await W({data:{id:n}});u.success(o.message)}catch(o){u.error(o.message)}finally{y()}}).catch(()=>{u.default("Cancel")})}async function k(){if(s.value.apiDailyLimit.apiUsageLeft>s.value.apiDailyLimit.maxLimit)return u.error("Usage Left must lower or equal than Max Limit");try{const{data:n}=await ee(s.value);u.success(n.message)}catch(n){u.error(n.message)}finally{y(),i.value=!1}}return(n,o)=>{const L=a("CCardHeader"),I=a("CProgress"),b=a("CTableDataCell"),x=a("CButton"),j=a("CSmartTable"),q=a("CCardBody"),N=a("CCard"),z=a("CIcon"),H=a("CModalTitle"),A=a("CModalHeader"),D=a("CFormInput"),M=a("CCol"),G=a("CInputGroupText"),E=a("CInputGroup"),Q=a("CForm"),X=a("CModalBody"),Y=a("CModal");return C(),U(F,null,[e(N,null,{default:t(()=>[e(L,null,{default:t(()=>[oe]),_:1}),e(q,null,{default:t(()=>[(C(),$(j,{key:_.value,clickableRows:"",loading:c.value,tableProps:{striped:!0,hover:!0,responsive:!0},activePage:1,header:"",items:p.value,columns:w.value,tableFilter:"",cleaner:"",itemsPerPageSelect:"",itemsPerPage:5,columnSorter:"",pagination:""},{apiUsage:t(({item:l})=>[e(b,null,{default:t(()=>[r("div",ne,[r("div",se,[r("strong",null,g(v(B)(l.apiDailyLimit.maxLimit,l.apiDailyLimit.apiUsageLeft).percent)+" % ",1)]),r("div",ie,[r("small",re,g(l.apiDailyLimit.apiUsageLeft)+" / "+g(l.apiDailyLimit.maxLimit),1)])]),e(I,{thin:"",color:v(B)(l.apiDailyLimit.maxLimit,l.apiDailyLimit.apiUsageLeft).color,value:v(B)(l.apiDailyLimit.maxLimit,l.apiDailyLimit.apiUsageLeft).percent},null,8,["color","value"])]),_:2},1024)]),date:t(({item:l})=>[r("td",null,g(l.apiDailyLimit.date),1)]),action:t(({item:l})=>[r("td",ue,[l.id!==1?(C(),U("div",de,[e(x,{size:"sm",color:"info",onClick:()=>{i.value=!0,h(l)}},{default:t(()=>[d(" Edit ")]),_:2},1032,["onClick"]),e(x,{size:"sm",color:"danger",class:"ml-1",onClick:_e=>V(l.id)},{default:t(()=>[d(" Delete ")]),_:2},1032,["onClick"])])):R("",!0)])]),_:1},8,["loading","items","columns"]))]),_:1})]),_:1}),e(Y,{backdrop:"static",visible:i.value,onClose:o[5]||(o[5]=()=>{i.value=!1})},{default:t(()=>[e(A,null,{default:t(()=>[e(H,null,{default:t(()=>[e(z,{icon:"cil-user"}),d(" "+g(s.value.clientCode),1)]),_:1})]),_:1}),e(X,null,{default:t(()=>[e(Q,{class:"row gy-2 align-items-center",onSubmit:S(k,["prevent"])},{default:t(()=>[e(M,{xs:"6",class:"mb-3",hidden:""},{default:t(()=>[e(D,{floatingLabel:"ID",type:"text",size:"sm",modelValue:s.value.id,"onUpdate:modelValue":o[0]||(o[0]=l=>s.value.id=l),required:""},null,8,["modelValue"])]),_:1}),e(M,{xs:"12",class:"mb-3"},{default:t(()=>[e(D,{floatingLabel:"Client Code",type:"text",size:"sm",modelValue:s.value.clientCode,"onUpdate:modelValue":o[1]||(o[1]=l=>s.value.clientCode=l),required:""},null,8,["modelValue"])]),_:1}),e(M,{xs:"auto",class:"mb-3"},{default:t(()=>[e(E,{class:"mb-3"},{default:t(()=>[e(G,null,{default:t(()=>[d("Max Limit (Daily)")]),_:1}),e(D,{placeholder:"Max Limit","aria-label":"Max Limit",type:"number",modelValue:s.value.apiDailyLimit.maxLimit,"onUpdate:modelValue":o[2]||(o[2]=l=>s.value.apiDailyLimit.maxLimit=l),modelModifiers:{number:!0}},null,8,["modelValue"]),e(G,null,{default:t(()=>[d(" Usage Left")]),_:1}),e(D,{placeholder:"Usage Left","aria-label":"Usage Left",type:"number",modelValue:s.value.apiDailyLimit.apiUsageLeft,"onUpdate:modelValue":o[3]||(o[3]=l=>s.value.apiDailyLimit.apiUsageLeft=l),modelModifiers:{number:!0}},null,8,["modelValue"])]),_:1})]),_:1}),ce,r("div",me,[e(x,{color:"secondary",onClick:o[4]||(o[4]=()=>{i.value=!1})},{default:t(()=>[d(" Close ")]),_:1}),e(x,{color:"primary",type:"submit"},{default:t(()=>[d("Save changes")]),_:1})])]),_:1})]),_:1})]),_:1},8,["visible"])],64)}}},fe={__name:"Index",setup(P){return(f,u)=>{const i=a("CCol"),c=a("CRow");return C(),U(F,null,[e(c,null,{default:t(()=>[e(i,{class:"mb-2"},{default:t(()=>[e(v(le))]),_:1})]),_:1}),e(c,null,{default:t(()=>[e(i,null,{default:t(()=>[e(v(pe))]),_:1})]),_:1})],64)}}};export{fe as default};
